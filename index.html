<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>IMSSA Mulhouse ‚Äì Exercices</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="site-header">
    <button id="btn-google" class="google-btn">üîí Se connecter</button>
    <h1>Exercices en ligne</h1>
    <p>√âtirements, Renforcement, R√©athl√©tisation</p>
  </header>

  <main class="site-content">
    <!-- Section √âtirements -->
    <section class="section-etirements">
      <h2>√âtirements - Mobilit√©</h2>
      <div class="grid">
        <div class="grid-item">
          <h3>Membre inf√©rieur</h3>
          <ul class="video-links">
            <li class="video-item">
              <a href="video.html?id=ID_INF1&label=Vid√©o+1+‚Äì+√âtirement+MI">Vid√©o 1 ‚Äì √âtirement MI</a>
              <button class="fav-btn" data-id="ID_INF1" data-label="Vid√©o 1 ‚Äì √âtirement MI"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=ID_INF2&label=Vid√©o+2+‚Äì+√âtirement+MI">Vid√©o 2 ‚Äì √âtirement MI</a>
              <button class="fav-btn" data-id="ID_INF2" data-label="Vid√©o 2 ‚Äì √âtirement MI"></button>
            </li>
          </ul>
        </div>
        <div class="grid-item">
          <h3>Membre sup√©rieur</h3>
          <ul class="video-links">
            <li class="video-item">
              <a href="video.html?id=ID_SUP1&label=Vid√©o+1+‚Äì+√âtirement+MS">Vid√©o 1 ‚Äì √âtirement MS</a>
              <button class="fav-btn" data-id="ID_SUP1" data-label="Vid√©o 1 ‚Äì √âtirement MS"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=ID_SUP2&label=Vid√©o+2+‚Äì+√âtirement+MS">Vid√©o 2 ‚Äì √âtirement MS</a>
              <button class="fav-btn" data-id="ID_SUP2" data-label="Vid√©o 2 ‚Äì √âtirement MS"></button>
            </li>
          </ul>
        </div>
        <div class="grid-item">
          <h3>Colonne</h3>
          <ul class="video-links">
            <li class="video-item">
              <a href="video.html?id=ID_COL1&label=Vid√©o+1+‚Äì+√âtirement+Colonne">Vid√©o 1 ‚Äì √âtirement Colonne</a>
              <button class="fav-btn" data-id="ID_COL1" data-label="Vid√©o 1 ‚Äì √âtirement Colonne"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=ID_COL2&label=Vid√©o+2+‚Äì+√âtirement+Colonne">Vid√©o 2 ‚Äì √âtirement Colonne</a>
              <button class="fav-btn" data-id="ID_COL2" data-label="Vid√©o 2 ‚Äì √âtirement Colonne"></button>
            </li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Section Renforcement -->
    <section class="section-renforcement">
      <h2>Renforcement - Proprioception</h2>
      <div class="grid">
        <div class="grid-item">
          <h3>Membre inf√©rieur</h3>
          <ul class="video-links">
            <li class="video-item">
              <a href="video.html?id=ID_RINF1&label=Vid√©o+1+‚Äì+Renforcement+MI">Vid√©o 1 ‚Äì Renforcement MI</a>
              <button class="fav-btn" data-id="ID_RINF1" data-label="Vid√©o 1 ‚Äì Renforcement MI"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=ID_RINF2&label=Vid√©o+2+‚Äì+Renforcement+MI">Vid√©o 2 ‚Äì Renforcement MI</a>
              <button class="fav-btn" data-id="ID_RINF2" data-label="Vid√©o 2 ‚Äì Renforcement MI"></button>
            </li>
          </ul>
        </div>
        <div class="grid-item">
          <h3>Membre sup√©rieur</h3>
          <ul class="video-links">
            <li class="video-item">
              <a href="video.html?id=ID_RSUP1&label=Vid√©o+1+‚Äì+Renforcement+MS">Vid√©o 1 ‚Äì Renforcement MS</a>
              <button class="fav-btn" data-id="ID_RSUP1" data-label="Vid√©o 1 ‚Äì Renforcement MS"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=ID_RSUP2&label=Vid√©o+2+‚Äì+Renforcement+MS">Vid√©o 2 ‚Äì Renforcement MS</a>
              <button class="fav-btn" data-id="ID_RSUP2" data-label="Vid√©o 2 ‚Äì Renforcement MS"></button>
            </li>
          </ul>
        </div>
        <div class="grid-item">
          <h3>Colonne</h3>
          <ul class="video-links">
            <li class="video-item">
              <a href="video.html?id=TSBuJYPxQjs&label=Adducteurs+omoplates">Adducteurs omoplates</a>
              <button class="fav-btn" data-id="TSBuJYPxQjs" data-label="Adducteurs omoplates"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=CPVFoSCOdiw&label=Autograndissement">Autograndissement</a>
              <button class="fav-btn" data-id="CPVFoSCOdiw" data-label="Autograndissement"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=PLyG9IALZ75hyAAE0ELHSn9h6xq_cH-Z3t&label=Renforcement+Colonne">Renforcement Colonne</a>
              <button class="fav-btn" data-id="PLyG9IALZ75hyAAE0ELHSn9h6xq_cH-Z3t" data-label="Renforcement Colonne"></button>
            </li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Section R√©athl√©tisation -->
    <section class="section-reathelitisation">
      <h2>R√©athl√©tisation</h2>
      <div class="grid">
        <div class="grid-item">
          <h3>Haut du corps</h3>
          <ul class="video-links">
            <li class="video-item">
              <a href="video.html?id=ID_HAUT1&label=Vid√©o+1+‚Äì+R√©athl.+Haut">Vid√©o 1 ‚Äì R√©athl. Haut</a>
              <button class="fav-btn" data-id="ID_HAUT1" data-label="Vid√©o 1 ‚Äì R√©athl. Haut"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=ID_HAUT2&label=Vid√©o+2+‚Äì+R√©athl.+Haut">Vid√©o 2 ‚Äì R√©athl. Haut</a>
              <button class="fav-btn" data-id="ID_HAUT2" data-label="Vid√©o 2 ‚Äì R√©athl. Haut"></button>
            </li>
          </ul>
        </div>
        <div class="grid-item">
          <h3>Bas du corps</h3>
          <ul class="video-links">
            <li class="video-item">
              <a href="video.html?id=ID_BAS1&label=Vid√©o+1+‚Äì+R√©athl.+Bas">Vid√©o 1 ‚Äì R√©athl. Bas</a>
              <button class="fav-btn" data-id="ID_BAS1" data-label="Vid√©o 1 ‚Äì R√©athl. Bas"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=ID_BAS2&label=Vid√©o+2+‚Äì+R√©athl.+Bas">Vid√©o 2 ‚Äì R√©athl. Bas</a>
              <button class="fav-btn" data-id="ID_BAS2" data-label="Vid√©o 2 ‚Äì R√©athl. Bas"></button>
            </li>
          </ul>
        </div>
        <div class="grid-item">
          <h3>Cardio</h3>
          <ul class="video-links">
            <li class="video-item">
              <a href="video.html?id=ID_CARD1&label=Vid√©o+1+‚Äì+Cardio">Vid√©o 1 ‚Äì Cardio</a>
              <button class="fav-btn" data-id="ID_CARD1" data-label="Vid√©o 1 ‚Äì Cardio"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=ID_CARD2&label=Vid√©o+2+‚Äì+Cardio">Vid√©o 2 ‚Äì Cardio</a>
              <button class="fav-btn" data-id="ID_CARD2" data-label="Vid√©o 2 ‚Äì Cardio"></button>
            </li>
          </ul>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <nav class="site-nav">
      <a href="menu.html">Mes favoris</a>
    </nav>
    <p>&copy; Cabinet Kin√©</p>
  </footer>

    <script type="module">
    // 1) Imports Firebase (v12 modules)
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
    import {
      getAuth,
      onAuthStateChanged,
      signInWithPopup,
      GoogleAuthProvider,
      signOut
    } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-auth.js";
    import {
      getFirestore,
      doc,
      getDoc,
      setDoc
    } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";

    // 2) Ta config Firebase (copi√©e depuis la console > CDN > Compat ou Modules)
    const firebaseConfig = {
      apiKey: "AIzaSyA7r18GtsCIi1n2AoaBFG-lAYyBPXFIw4Q",
      authDomain: "imssa-2d3cb.firebaseapp.com",
      projectId: "imssa-2d3cb",
      storageBucket: "imssa-2d3cb.appspot.com",
      messagingSenderId: "976927404721",
      appId: "1:976927404721:web:3484dd21e9e52a1e692890",
      measurementId: "G-SKTEPM9LKC"
    };

    // 3) Initialisation Firebase
    const app  = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db   = getFirestore(app);

    // 4) Gestion du bouton Google Sign-In / Sign-Out
    const btnGoogle = document.getElementById("btn-google");
    btnGoogle.addEventListener("click", () => {
      if (!auth.currentUser) {
        signInWithPopup(auth, new GoogleAuthProvider()).catch(console.error);
      } else {
        signOut(auth).catch(console.error);
      }
    });

    // 5) √âcoute de l‚Äô√©tat de connexion et initialisation des boutons ‚ù§Ô∏è/ü©∂
    onAuthStateChanged(auth, async user => {
      if (user) {
        btnGoogle.textContent = `üë§ ${user.displayName}`;
        // R√©cup√®re les favoris dans Firestore
        const ref  = doc(db, "users", user.uid);
        const snap = await getDoc(ref);
        const favs = snap.exists() ? snap.data().favoris : [];
        initButtons(favs, user.uid);
      } else {
        btnGoogle.textContent = "üîí Se connecter";
        initButtons([], null);
      }
    });

    // 6) Fonctions de gestion des favoris
    async function toggleFavori(id, label, btn, uid) {
      if (!uid) {
        alert("Connectez-vous d‚Äôabord pour g√©rer vos favoris.");
        return;
      }
      const ref  = doc(db, "users", uid);
      const snap = await getDoc(ref);
      let favs    = snap.exists() ? snap.data().favoris : [];
      const idx   = favs.findIndex(f => f.id === id);
      if (idx !== -1) favs.splice(idx, 1);
      else            favs.push({ id, label });
      // Sauvegarde en base
      await setDoc(ref, { favoris: favs }, { merge: true });
      // Mise √† jour du bouton
      btn.textContent = idx !== -1 ? "ü©∂" : "‚ù§Ô∏è";
    }

    function initButtons(favs, uid) {
      document.querySelectorAll(".fav-btn").forEach(btn => {
        const { id, label } = btn.dataset;
        btn.textContent = favs.some(f => f.id === id) ? "‚ù§Ô∏è" : "ü©∂";
        btn.onclick = () => toggleFavori(id, label, btn, uid);
      });
    }
  </script>
</body>
</html> 
