<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>IMSSA Mulhouse ‚Äì Exercices</title>
  <link rel="stylesheet" href="styles.css" />

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <script>
    // 1) Ta configuration Firebase (issue de la console)
    const firebaseConfig = {
      apiKey: "AIzaSyA7r18GtsCI1n2AoaBFG-lAYyBPXFIw4Q",
      authDomain: "imssa-2d3cb.firebaseapp.com",
      projectId: "imssa-2d3cb",
      storageBucket: "imssa-2d3cb.appspot.com",
      messagingSenderId: "976927404721",
      appId: "1:976927404721:web:3484dd21e9e52a1e692890",
      measurementId: "G-SKTEPM9LKC"
    };
    // 2) Initialisation
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db   = firebase.firestore();
  </script>
</head>
<body>
  <header class="site-header">
    <button id="btn-google" class="google-btn">üîí Se connecter</button>
    <h1>Exercices en ligne</h1>
    <p>√âtirements, Renforcement, R√©athl√©tisation</p>
  </header>

  <main class="site-content">
    <!-- Section √âtirements -->
    <section class="section-etirements">
      <h2>√âtirements - Mobilit√©</h2>
      <div class="grid">
        <div class="grid-item">
          <h3>Membre inf√©rieur</h3>
          <ul class="video-links">
            <li class="video-item">
              <a href="video.html?id=ID_INF1&label=Vid√©o+1+‚Äì+√âtirement+MI">Vid√©o 1 ‚Äì √âtirement MI</a>
              <button class="fav-btn" data-id="ID_INF1" data-label="Vid√©o 1 ‚Äì √âtirement MI"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=ID_INF2&label=Vid√©o+2+‚Äì+√âtirement+MI">Vid√©o 2 ‚Äì √âtirement MI</a>
              <button class="fav-btn" data-id="ID_INF2" data-label="Vid√©o 2 ‚Äì √âtirement MI"></button>
            </li>
          </ul>
        </div>
        <div class="grid-item">
          <h3>Membre sup√©rieur</h3>
          <ul class="video-links">
            <li class="video-item">
              <a href="video.html?id=ID_SUP1&label=Vid√©o+1+‚Äì+√âtirement+MS">Vid√©o 1 ‚Äì √âtirement MS</a>
              <button class="fav-btn" data-id="ID_SUP1" data-label="Vid√©o 1 ‚Äì √âtirement MS"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=ID_SUP2&label=Vid√©o+2+‚Äì+√âtirement+MS">Vid√©o 2 ‚Äì √âtirement MS</a>
              <button class="fav-btn" data-id="ID_SUP2" data-label="Vid√©o 2 ‚Äì √âtirement MS"></button>
            </li>
          </ul>
        </div>
        <div class="grid-item">
          <h3>Colonne</h3>
          <ul class="video-links">
            <li class="video-item">
              <a href="video.html?id=ID_COL1&label=Vid√©o+1+‚Äì+√âtirement+Colonne">Vid√©o 1 ‚Äì √âtirement Colonne</a>
              <button class="fav-btn" data-id="ID_COL1" data-label="Vid√©o 1 ‚Äì √âtirement Colonne"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=ID_COL2&label=Vid√©o+2+‚Äì+√âtirement+Colonne">Vid√©o 2 ‚Äì √âtirement Colonne</a>
              <button class="fav-btn" data-id="ID_COL2" data-label="Vid√©o 2 ‚Äì √âtirement Colonne"></button>
            </li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Section Renforcement -->
    <section class="section-renforcement">
      <h2>Renforcement - Proprioception</h2>
      <div class="grid">
        <div class="grid-item">
          <h3>Membre inf√©rieur</h3>
          <ul class="video-links">
            <li class="video-item">
              <a href="video.html?id=ID_RINF1&label=Vid√©o+1+‚Äì+Renforcement+MI">Vid√©o 1 ‚Äì Renforcement MI</a>
              <button class="fav-btn" data-id="ID_RINF1" data-label="Vid√©o 1 ‚Äì Renforcement MI"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=ID_RINF2&label=Vid√©o+2+‚Äì+Renforcement+MI">Vid√©o 2 ‚Äì Renforcement MI</a>
              <button class="fav-btn" data-id="ID_RINF2" data-label="Vid√©o 2 ‚Äì Renforcement MI"></button>
            </li>
          </ul>
        </div>
        <div class="grid-item">
          <h3>Membre sup√©rieur</h3>
          <ul class="video-links">
            <li class="video-item">
              <a href="video.html?id=ID_RSUP1&label=Vid√©o+1+‚Äì+Renforcement+MS">Vid√©o 1 ‚Äì Renforcement MS</a>
              <button class="fav-btn" data-id="ID_RSUP1" data-label="Vid√©o 1 ‚Äì Renforcement MS"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=ID_RSUP2&label=Vid√©o+2+‚Äì+Renforcement+MS">Vid√©o 2 ‚Äì Renforcement MS</a>
              <button class="fav-btn" data-id="ID_RSUP2" data-label="Vid√©o 2 ‚Äì Renforcement MS"></button>
            </li>
          </ul>
        </div>
        <div class="grid-item">
          <h3>Colonne</h3>
          <ul class="video-links">
            <li class="video-item">
              <a href="video.html?id=TSBuJYPxQjs&label=Adducteurs+omoplates">Adducteurs omoplates</a>
              <button class="fav-btn" data-id="TSBuJYPxQjs" data-label="Adducteurs omoplates"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=CPVFoSCOdiw&label=Autograndissement">Autograndissement</a>
              <button class="fav-btn" data-id="CPVFoSCOdiw" data-label="Autograndissement"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=PLyG9IALZ75hyAAE0ELHSn9h6xq_cH-Z3t&label=Renforcement+Colonne">Renforcement Colonne</a>
              <button class="fav-btn" data-id="PLyG9IALZ75hyAAE0ELHSn9h6xq_cH-Z3t" data-label="Renforcement Colonne"></button>
            </li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Section R√©athl√©tisation -->
    <section class="section-reathelitisation">
      <h2>R√©athl√©tisation</h2>
      <div class="grid">
        <div class="grid-item">
          <h3>Haut du corps</h3>
          <ul class="video-links">
            <li class="video-item">
              <a href="video.html?id=ID_HAUT1&label=Vid√©o+1+‚Äì+R√©athl.+Haut">Vid√©o 1 ‚Äì R√©athl. Haut</a>
              <button class="fav-btn" data-id="ID_HAUT1" data-label="Vid√©o 1 ‚Äì R√©athl. Haut"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=ID_HAUT2&label=Vid√©o+2+‚Äì+R√©athl.+Haut">Vid√©o 2 ‚Äì R√©athl. Haut</a>
              <button class="fav-btn" data-id="ID_HAUT2" data-label="Vid√©o 2 ‚Äì R√©athl. Haut"></button>
            </li>
          </ul>
        </div>
        <div class="grid-item">
          <h3>Bas du corps</h3>
          <ul class="video-links">
            <li class="video-item">
              <a href="video.html?id=ID_BAS1&label=Vid√©o+1+‚Äì+R√©athl.+Bas">Vid√©o 1 ‚Äì R√©athl. Bas</a>
              <button class="fav-btn" data-id="ID_BAS1" data-label="Vid√©o 1 ‚Äì R√©athl. Bas"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=ID_BAS2&label=Vid√©o+2+‚Äì+R√©athl.+Bas">Vid√©o 2 ‚Äì R√©athl. Bas</a>
              <button class="fav-btn" data-id="ID_BAS2" data-label="Vid√©o 2 ‚Äì R√©athl. Bas"></button>
            </li>
          </ul>
        </div>
        <div class="grid-item">
          <h3>Cardio</h3>
          <ul class="video-links">
            <li class="video-item">
              <a href="video.html?id=ID_CARD1&label=Vid√©o+1+‚Äì+Cardio">Vid√©o 1 ‚Äì Cardio</a>
              <button class="fav-btn" data-id="ID_CARD1" data-label="Vid√©o 1 ‚Äì Cardio"></button>
            </li>
            <li class="video-item">
              <a href="video.html?id=ID_CARD2&label=Vid√©o+2+‚Äì+Cardio">Vid√©o 2 ‚Äì Cardio</a>
              <button class="fav-btn" data-id="ID_CARD2" data-label="Vid√©o 2 ‚Äì Cardio"></button>
            </li>
          </ul>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <nav class="site-nav">
      <a href="menu.html">Mes favoris</a>
    </nav>
    <p>&copy; Cabinet Kin√©</p>
  </footer>

  <script>
    // Gestion de l'√©tat de connexion Google
    const btnGoogle = document.getElementById('btn-google');
    auth.onAuthStateChanged(async user => {
      if (user) {
        btnGoogle.textContent = `üë§ ${user.displayName}`;
        const snap = await db.collection('users').doc(user.uid).get();
        initButtons(snap.exists ? snap.data().favoris : [], user.uid);
      } else {
        btnGoogle.textContent = 'üîí Se connecter';
        initButtons([], null);
      }
    });
    btnGoogle.onclick = () => {
      if (!auth.currentUser) {
        auth.signInWithPopup(new firebase.auth.GoogleAuthProvider());
      } else {
        auth.signOut();
      }
    };

    // Initialisation des boutons favoris
    async function initButtons(favs, uid) {
      document.querySelectorAll('.fav-btn').forEach(btn => {
        const { id, label } = btn.dataset;
        btn.textContent = favs.some(f => f.id === id) ? '‚ù§Ô∏è' : 'ü©∂';
        btn.onclick = () => toggleFavori(id, label, btn, uid);
      });
    }

    // Toggle et sauvegarde en Firestore
    async function toggleFavori(id, label, btn, uid) {
      if (!uid) return alert('Connectez-vous pour g√©rer vos favoris.');
      const ref = db.collection('users').doc(uid);
      const snap = await ref.get();
      let favs = snap.exists ? snap.data().favoris : [];
      const idx = favs.findIndex(f => f.id === id);
      if (idx !== -1) favs.splice(idx, 1);
      else favs.push({ id, label });
      await ref.set({ favoris: favs }, { merge: true });
      btn.textContent = idx !== -1 ? 'ü©∂' : '‚ù§Ô∏è';
    }
  </script>
</body>
</html>
